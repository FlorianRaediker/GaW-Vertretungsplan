(function(){'use strict';const r=document.getElementById("selectionInput").value,u=window.location.pathname.split("/",2)[1];let v;try{(v=JSON.parse(window.localStorage.getItem(u+"-timetables")))||(v={})}catch{v={}}const y=document.getElementById("timetables-block");
if(r){const t={};for(let q of document.getElementsByClassName("substitutions-box")){const h=q.querySelector(".substitutions-table tbody");if(h){const m=q.querySelector(".day-name").textContent;let f=null,d=[{},{},{},{},{},{},{},{},{},{}];function l(){var c=[];var e=f.match(/^(\d+)([A-Za-z]*)$/);if(null!=e){var g=e[1];e=e[2].toUpperCase()}else g="",e=f.toUpperCase();if(""!==g)if(""!==e)for(let a of e)c.push(g+a);else c.push(g);else c.push(e);g=[];for(let a of r.split(", ")){a=a.toUpperCase();for(let k of c)if(k.includes(a)){g.push(a);
break}}console.log(f,c,g);for(let a of g)if(a in t||(t[a]={}),m in t[a])for(c=0;10>c;c++)t[a][m][c]=Object.assign(t[a][m][c],d[c]);else t[a][m]=d}for(let c of h.children){let e=c.querySelector(".group-name"),g,a;null!=e?(null!=f&&l(),d=[{},{},{},{},{},{},{},{},{},{}],f=e.textContent,g=c.children[1].textContent.toUpperCase(),a=c.children[3].textContent):(g=c.children[0].textContent.toUpperCase(),a=c.children[2].textContent);for(let k of a.match(/(\d+)/g))k=parseInt(k),g in d[k-1]?d[k-1][g].push(c):
d[k-1][g]=[c]}null!=f&&l()}}console.log(t);const z=document.getElementById("timetables-block-template"),A=document.getElementById("timetable-template");y.appendChild(z.content);const B=document.getElementById("timetables-container");function w(q,h=null,m=!0){h||(h=q.value);var f=q.dataset.selection;if(f in t){f=t[f];let d=q.dataset.weekdayName;if(d in f&&(h=h.toUpperCase(),f=f[d][q.dataset.lesson-1],h in f))for(let l of f[h])m?l.classList.add("is-relevant"):l.classList.remove("is-relevant")}}for(let q of r.split(", ")){let h=
q.toUpperCase();h in v||(v[h]=[[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]]);const m=A.content.firstElementChild.cloneNode(!0);B.appendChild(m);m.querySelectorAll(".timetable-selection").forEach(d=>d.innerText=q);m.querySelector(".share-timetable-button").addEventListener("click",()=>
{const d=m.querySelector(".share-timetable-block");if(d.hidden){const l=d.querySelector(".timetable-link-input"),c=d.querySelector(".copy-timetable-link");l.value=(new URL("/"+u+"/#timetable:"+h+":"+btoa(JSON.stringify(v[h])),window.location.origin)).href;l.addEventListener("click",g=>g.target.select());let e=null;c.addEventListener("click",()=>{navigator.clipboard.writeText(l.value).then(()=>{c.classList.add("copied");c.title="Kopiert!";null!=e&&clearTimeout(e);e=setTimeout(()=>{c.classList.remove("copied");
c.title="Kopieren";e=null},2E3)})});d.hidden=!1}else d.hidden=!0});const f=m.querySelector("tbody");for(let d=1;11>d;d++){const l=document.createElement("tr");f.appendChild(l);const c=document.createElement("th");l.appendChild(c);c.innerText=d+".";for(let a=0;5>a;a++){const k=document.createElement("td");l.appendChild(k);const b=document.createElement("input");k.appendChild(b);b.classList.add("form-control","form-control-sm");b.id="timetable-"+h+"-"+a+"-"+d;const n=["Montag","Dienstag","Mittwoch",
"Donnerstag","Freitag"][a];b.setAttribute("type","text");b.setAttribute("autocapitalize","characters");b.setAttribute("autocomplete","off");b.setAttribute("autocorrect","off");b.setAttribute("spellcheck","false");b.setAttribute("enterkeyhint",4===a&&10===d?"done":"next");b.setAttribute("maxlength","3");b.setAttribute("aria-label",`${d}. Stunde ${n}`);b.addEventListener("focus",p=>p.target.select());b.addEventListener("input",p=>{w(p.target,p.target.dataset.oldvalue,!1);w(p.target);p.target.dataset.oldvalue=
p.target.value;v[p.target.dataset.selection][parseInt(p.target.dataset.weekday)][parseInt(p.target.dataset.lesson)-1]=p.target.value.toUpperCase();window.localStorage.setItem(u+"-timetables",JSON.stringify(v))});b.dataset.selection=h;b.dataset.weekday=a;b.dataset.weekdayName=n;b.dataset.lesson=d;let x=v[h][a][d-1];null!=x?(b.value=x,b.dataset.oldvalue=x,w(b)):b.dataset.oldvalue=""}function e(a,k){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);n+=k;if(1>n){b--;if(0>b)return!1;n=10}else if(10<
n){b++;if(5<=b)return a.blur(),!1;n=1}document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus();return!0}function g(a,k){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);b+=k;return 0<=b&&4>=b?(document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus(),!0):!1}f.addEventListener("keydown",a=>{switch(a.key){case "Tab":case "Enter":e(a.target,a.shiftKey?-1:1)&&a.preventDefault();break;case "ArrowDown":e(a.target,1)&&a.preventDefault();break;case "ArrowUp":e(a.target,
-1)&&a.preventDefault();break;case "ArrowLeft":0!==a.target.selectionStart||1!==a.target.selectionEnd&&0!==a.target.selectionEnd||g(a.target,-1)&&a.preventDefault();break;case "ArrowRight":a.target.selectionStart===a.target.selectionEnd&&g(a.target,1)&&a.preventDefault()}});f.addEventListener("input",a=>{a.target.value.length>=a.target.maxLength&&e(a.target,1)})}}};}).call(this);

//# sourceMappingURL=timetables.min.js.map
