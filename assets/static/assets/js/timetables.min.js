(function(){'use strict';const r=document.getElementById("selectionInput").value,u=window.location.pathname.split("/",2)[1];let v;try{(v=JSON.parse(window.localStorage.getItem(u+"-timetables")))||(v={})}catch{v={}}const y=document.getElementById("timetables-block");
if(r){const t={};for(let q of document.getElementsByClassName("substitutions-box")){const k=q.querySelector(".substitutions-table tbody");if(k){const m=q.querySelector(".day-name").textContent;let g=null,d=[{},{},{},{},{},{},{},{},{},{}];function l(){var c=[];var f=g.match(/^(\d+)([A-Za-z]*)$/);if(null!=f){var e=f[1];f=f[2].toUpperCase()}else e="",f=g.toUpperCase();if(""!==e)if(""!==f)for(let a of f)c.push(e+a);else c.push(e);else c.push(f);e=[];for(let a of r.split(", ")){a=a.toUpperCase();for(let h of c)if(h.includes(a)){e.push(a);
break}}console.log(g,c,e);for(let a of e)if(a in t||(t[a]={}),m in t[a])for(c=0;10>c;c++)t[a][m][c]=Object.assign(t[a][m][c],d[c]);else t[a][m]=d}for(let c of k.children){let f=c.querySelector(".group-name"),e,a;null!=f?(null!=g&&l(),d=[{},{},{},{},{},{},{},{},{},{}],g=f.textContent,e=c.children[1].textContent.toUpperCase(),a=c.children[3].textContent):(e=c.children[0].textContent.toUpperCase(),a=c.children[2].textContent);for(let h of a.match(/(\d+)/g))h=parseInt(h),e in d[h-1]?d[h-1][e].push(c):
d[h-1][e]=[c]}null!=g&&l()}}console.log(t);const z=document.getElementById("timetables-block-template"),A=document.getElementById("timetable-template");y.appendChild(z.content);const B=document.getElementById("timetables-container");function w(q,k=null,m=!0){k||(k=q.value);var g=q.dataset.selection;if(g in t){g=t[g];let d=q.dataset.weekdayName;if(d in g&&(k=k.toUpperCase(),g=g[d][q.dataset.lesson-1],k in g))for(let l of g[k])m?l.classList.add("is-relevant"):l.classList.remove("is-relevant")}}for(let q of r.split(", ")){let k=
q.toUpperCase();k in v||(v[k]=[[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]]);const m=A.content.firstElementChild.cloneNode(!0);B.appendChild(m);m.querySelectorAll(".timetable-selection").forEach(d=>d.innerText=q);m.querySelector(".share-timetable-button").addEventListener("click",()=>
{const d=m.querySelector(".share-timetable-block");if(d.hidden){const l=d.querySelector(".timetable-link-input"),c=d.querySelector(".copy-timetable-link");let f="";for(let a=0;5>a;a++)for(let h=0;10>h;h++){let b=v[k][a][h];null==b?f+="   ":(3<b.length&&(b=b.substr(0,3)),f+=b+" ".repeat(3-b.length))}l.value=(new URL("/"+u+"/#timetable:"+k+":"+btoa(f),window.location.origin)).href;l.addEventListener("click",a=>a.target.select());let e=null;c.addEventListener("click",()=>{function a(){null!=e&&clearTimeout(e);
e=setTimeout(()=>{c.classList.remove("copied");c.classList.remove("copying-failed");c.title="Kopieren";e=null},2E3)}navigator.clipboard.writeText(l.value).then(()=>{c.classList.add("copied");c.title="Kopiert!";a()}).catch(()=>{c.classList.add("copying-failed");c.title="Kopieren fehlgeschlagen";a()})});d.hidden=!1}else d.hidden=!0});const g=m.querySelector("tbody");for(let d=1;11>d;d++){const l=document.createElement("tr");g.appendChild(l);const c=document.createElement("th");l.appendChild(c);c.innerText=
d+".";for(let a=0;5>a;a++){const h=document.createElement("td");l.appendChild(h);const b=document.createElement("input");h.appendChild(b);b.classList.add("form-control","form-control-sm");b.id="timetable-"+k+"-"+a+"-"+d;const n=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"][a];b.setAttribute("type","text");b.setAttribute("autocapitalize","characters");b.setAttribute("autocomplete","off");b.setAttribute("autocorrect","off");b.setAttribute("spellcheck","false");b.setAttribute("enterkeyhint",
4===a&&10===d?"done":"next");b.setAttribute("maxlength","3");b.setAttribute("aria-label",`${d}. Stunde ${n}`);b.addEventListener("focus",p=>p.target.select());b.addEventListener("input",p=>{w(p.target,p.target.dataset.oldvalue,!1);w(p.target);p.target.dataset.oldvalue=p.target.value;v[p.target.dataset.selection][parseInt(p.target.dataset.weekday)][parseInt(p.target.dataset.lesson)-1]=p.target.value.toUpperCase();window.localStorage.setItem(u+"-timetables",JSON.stringify(v))});b.dataset.selection=
k;b.dataset.weekday=a;b.dataset.weekdayName=n;b.dataset.lesson=d;let x=v[k][a][d-1];null!=x?(b.value=x,b.dataset.oldvalue=x,w(b)):b.dataset.oldvalue=""}function f(a,h){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);n+=h;if(1>n){b--;if(0>b)return!1;n=10}else if(10<n){b++;if(5<=b)return a.blur(),!1;n=1}document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus();return!0}function e(a,h){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);b+=h;return 0<=b&&
4>=b?(document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus(),!0):!1}g.addEventListener("keydown",a=>{switch(a.key){case "Tab":case "Enter":f(a.target,a.shiftKey?-1:1)&&a.preventDefault();break;case "ArrowDown":f(a.target,1)&&a.preventDefault();break;case "ArrowUp":f(a.target,-1)&&a.preventDefault();break;case "ArrowLeft":0!==a.target.selectionStart||1!==a.target.selectionEnd&&0!==a.target.selectionEnd||e(a.target,-1)&&a.preventDefault();break;case "ArrowRight":a.target.selectionStart===
a.target.selectionEnd&&e(a.target,1)&&a.preventDefault()}});g.addEventListener("input",a=>{a.target.value.length>=a.target.maxLength&&f(a.target,1)})}}};}).call(this);

//# sourceMappingURL=timetables.min.js.map
