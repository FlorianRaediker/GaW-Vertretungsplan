(function(){'use strict';const r=document.getElementById("selectionInput").value,u=window.location.pathname.split("/",2)[1];let v;try{(v=JSON.parse(window.localStorage.getItem(u+"-timetables")))||(v={})}catch{v={}}const y=document.getElementById("timetables-block");
if(r){const t={};for(let q of document.getElementsByClassName("substitutions-box")){const h=q.querySelector(".substitutions-table tbody");if(h){const m=q.querySelector(".day-name").textContent;let g=null,d=[{},{},{},{},{},{},{},{},{},{}];function l(){var c=[];var f=g.match(/^(\d+)([A-Za-z]*)$/);if(null!=f){var e=f[1];f=f[2].toUpperCase()}else e="",f=g.toUpperCase();if(""!==e)if(""!==f)for(let a of f)c.push(e+a);else c.push(e);else c.push(f);e=[];for(let a of r.split(", ")){a=a.toUpperCase();for(let k of c)if(k.includes(a)){e.push(a);
break}}console.log(g,c,e);for(let a of e)if(a in t||(t[a]={}),m in t[a])for(c=0;10>c;c++)t[a][m][c]=Object.assign(t[a][m][c],d[c]);else t[a][m]=d}for(let c of h.children){let f=c.querySelector(".group-name"),e,a;null!=f?(null!=g&&l(),d=[{},{},{},{},{},{},{},{},{},{}],g=f.textContent,e=c.children[1].textContent.toUpperCase(),a=c.children[3].textContent):(e=c.children[0].textContent.toUpperCase(),a=c.children[2].textContent);for(let k of a.match(/(\d+)/g))k=parseInt(k),e in d[k-1]?d[k-1][e].push(c):
d[k-1][e]=[c]}null!=g&&l()}}console.log(t);const z=document.getElementById("timetables-block-template"),A=document.getElementById("timetable-template");y.appendChild(z.content);const B=document.getElementById("timetables-container");function w(q,h=null,m=!0){h||(h=q.value);var g=q.dataset.selection;if(g in t){g=t[g];let d=q.dataset.weekdayName;if(d in g&&(h=h.toUpperCase(),g=g[d][q.dataset.lesson-1],h in g))for(let l of g[h])m?l.classList.add("is-relevant"):l.classList.remove("is-relevant")}}for(let q of r.split(", ")){let h=
q.toUpperCase();h in v||(v[h]=[[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]]);const m=A.content.firstElementChild.cloneNode(!0);B.appendChild(m);m.querySelectorAll(".timetable-selection").forEach(d=>d.innerText=q);m.querySelector(".share-timetable-button").addEventListener("click",()=>
{const d=m.querySelector(".share-timetable-block");if(d.hidden){const l=d.querySelector(".timetable-link-input"),c=d.querySelector(".copy-timetable-link");l.value=(new URL("/"+u+"/#timetable:"+h+":"+btoa(JSON.stringify(v[h])),window.location.origin)).href;l.addEventListener("click",e=>e.target.select());let f=null;c.addEventListener("click",()=>{function e(){null!=f&&clearTimeout(f);f=setTimeout(()=>{c.classList.remove("copied");c.classList.remove("copying-failed");c.title="Kopieren";f=null},2E3)}
navigator.clipboard.writeText(l.value).then(()=>{c.classList.add("copied");c.title="Kopiert!";e()}).catch(()=>{c.classList.add("copying-failed");c.title="Kopieren fehlgeschlagen";e()})});d.hidden=!1}else d.hidden=!0});const g=m.querySelector("tbody");for(let d=1;11>d;d++){const l=document.createElement("tr");g.appendChild(l);const c=document.createElement("th");l.appendChild(c);c.innerText=d+".";for(let a=0;5>a;a++){const k=document.createElement("td");l.appendChild(k);const b=document.createElement("input");
k.appendChild(b);b.classList.add("form-control","form-control-sm");b.id="timetable-"+h+"-"+a+"-"+d;const n=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"][a];b.setAttribute("type","text");b.setAttribute("autocapitalize","characters");b.setAttribute("autocomplete","off");b.setAttribute("autocorrect","off");b.setAttribute("spellcheck","false");b.setAttribute("enterkeyhint",4===a&&10===d?"done":"next");b.setAttribute("maxlength","3");b.setAttribute("aria-label",`${d}. Stunde ${n}`);b.addEventListener("focus",
p=>p.target.select());b.addEventListener("input",p=>{w(p.target,p.target.dataset.oldvalue,!1);w(p.target);p.target.dataset.oldvalue=p.target.value;v[p.target.dataset.selection][parseInt(p.target.dataset.weekday)][parseInt(p.target.dataset.lesson)-1]=p.target.value.toUpperCase();window.localStorage.setItem(u+"-timetables",JSON.stringify(v))});b.dataset.selection=h;b.dataset.weekday=a;b.dataset.weekdayName=n;b.dataset.lesson=d;let x=v[h][a][d-1];null!=x?(b.value=x,b.dataset.oldvalue=x,w(b)):b.dataset.oldvalue=
""}function f(a,k){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);n+=k;if(1>n){b--;if(0>b)return!1;n=10}else if(10<n){b++;if(5<=b)return a.blur(),!1;n=1}document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus();return!0}function e(a,k){let b=parseInt(a.dataset.weekday),n=parseInt(a.dataset.lesson);b+=k;return 0<=b&&4>=b?(document.getElementById("timetable-"+a.dataset.selection+"-"+b+"-"+n).focus(),!0):!1}g.addEventListener("keydown",a=>{switch(a.key){case "Tab":case "Enter":f(a.target,
a.shiftKey?-1:1)&&a.preventDefault();break;case "ArrowDown":f(a.target,1)&&a.preventDefault();break;case "ArrowUp":f(a.target,-1)&&a.preventDefault();break;case "ArrowLeft":0!==a.target.selectionStart||1!==a.target.selectionEnd&&0!==a.target.selectionEnd||e(a.target,-1)&&a.preventDefault();break;case "ArrowRight":a.target.selectionStart===a.target.selectionEnd&&e(a.target,1)&&a.preventDefault()}});g.addEventListener("input",a=>{a.target.value.length>=a.target.maxLength&&f(a.target,1)})}}};}).call(this);

//# sourceMappingURL=timetables.min.js.map
