'use strict';const b=document.getElementsByClassName("date");
function d(){const a=new Date;if(0<b.length&&b[0].innerHTML===a.getDate()+"."+(a.getMonth()+1)+"."+a.getFullYear()){const n=a.getHours(),r=a.getMinutes();for(let c of[["1",8,35],["2",9,25],["3",10,30],["4",11,15],["5",12,20],["6",13,10],["7",14,35],["8",15,25],["9",16,20],["10",17,5]])if(c[1]<n||c[1]===n&&c[2]<=r)for(let a of document.getElementsByClassName("lesson"+c[0]))a.classList.add("grey");else{setTimeout(d,(new Date(a.getFullYear(),a.getMonth(),a.getDate(),c[1],c[2])).getTime()-a.getTime());
break}}}d();let e=window.location.pathname.split("/",2)[1];e||(e="students");const f=new WebSocket(("http:"===window.location.protocol?"ws:":"wss:")+"//"+window.location.host+window.location.pathname+"api/wait-for-updates");f.onopen=a=>{console.log("WebSocket opened",a);g.textContent="Aktuell";g.classList.add("online");g.classList.remove("offline")};f.onclose=a=>{console.log("WebSocket closed",a);g.textContent="Keine Verbindung zum Server";g.classList.add("offline");g.classList.remove("online")};
f.onmessage=a=>{a=JSON.parse(a.data);console.log("WebSocket message",a);window.location.reload()};
const g=document.getElementById("online-status"),h=document.getElementById("selectionInput").value,k=document.getElementById("toggle-notifications"),l=document.getElementById("notifications-info"),m=document.getElementById("notifications-info-none"),p=document.getElementById("notifications-info-all"),q=document.getElementById("notifications-info-selection"),t=document.getElementById("notifications-info-blocked"),u=document.getElementById("notifications-info-failed");let v;
function w(a){v=a;window.localStorage.setItem(e+"-notification-state",v);switch(v){case "granted-and-enabled":k.checked=!0;m.hidden=!0;l.innerHTML=""!==h?q.innerHTML.replace("{selection}",h):p.innerHTML;break;case "denied":k.checked=!1;k.disabled=!0;l.innerHTML=t.innerHTML;break;case "failed":l.innerHTML=u.innerHTML;break;default:case "granted-and-disabled":case "default":k.checked=!1,l.innerHTML=m.innerHTML}}
function x(){document.getElementById("notifications-block").hidden=!1;k.addEventListener("change",()=>{k.checked?window.Notification.requestPermission().then(a=>{switch(a){case "granted":v="granted-and-enabled";break;default:v=a}w(v)}):"granted-and-enabled"===v&&w("granted-and-disabled")});v=window.localStorage.getItem(e+"-notification-state");null!=v?w(v):w("default")}
"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.min.js").then(a=>{console.log("ServiceWorker registration successful:",a);"Notification"in window?"localStorage"in window?x():console.warn("localStorage is not supported"):console.warn("Notification is not supported")}).catch(a=>console.warn("ServiceWorker registration failed:",a))}):console.warn("serviceWorker is not supported");//# sourceMappingURL=substitutions.min.js.map
